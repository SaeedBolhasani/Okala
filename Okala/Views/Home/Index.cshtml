@{
    ViewData["Title"] = "Home Page";
}

<style>
    /* Add your existing styles here, with any additional styles you need */
    /* Input and select styles */
    .search-form {
        margin-bottom: 30px;
    }

        .search-form input[type="text"], .search-form select {
            padding: 10px;
            border-radius: 5px;
            border: 1px solid #ddd;
            width: 300px;
            margin-right: 10px;
            font-size: 16px;
        }

        .search-form input[type="submit"] {
            /* Keep your existing submit button styles */
        }

    /* Table styles */
    table {
        /* Your existing table styles */
    }
</style>

<div class="text-center">
    <h1>Cryptocurrency Information</h1>
    @using (Html.BeginForm("index", "home", FormMethod.Post, new { @class = "search-form" }))
    {
        @*   <select id="symbolSelect" contenteditable="true" name="symbol" style="position:absolute; top:0; left:0; width:100%; z-index: 0;display:none"></select>
    *@
        <div style="position:absolute; width:300px; height:45px">

            <select class="js-data-example-ajax"></select>
            @*         <input id="symbolInput" type="text" placeholder="Enter cryptocurrency symbol (e.g. BTC)" style="position:absolute; top:0; left:0; width:100%; height:100%; z-index: 1;display:none" />
        *@
        </div>



        <input type="submit" title="Search" value="Search" />
    }

    <table>
        <tr>
            <th>Name</th>
            <th>Symbol</th>
        </tr>
        @if (Model != null)
        {
            @foreach (var symbolInfo in Model)
            {
                <tr>
                    <td>@symbolInfo.Name</td>
                    <td>@symbolInfo.Symbol</td>
                </tr>
            }
        }
        else
        {
            <tr>
                <td colspan="4" style="text-align:center;">No data found</td>
            </tr>
        }
    </table>
</div>

<script>
    $('.js-data-example-ajax').select2({
        ajax: {
            url: 'home/search',
            dataType: 'json',
            data: function (params) {
                var query = {
                    symbol: params.term,
                    type: 'public'
                }

                // Query parameters will be ?search=[term]&type=public
                return query;
            }
            // Additional AJAX parameters go here; see the end of this chapter for the full code of this example
        }
    });
    // $(document).ready(function () {
    //     $('#symbolInput').on('input', function () {
    //         var inputValue = $(this).val();
    //         if (inputValue.length >= 2) {
    //             // Call your API to fetch symbols
    //             $.ajax({
    //                 url: 'home/search?symbol=' + inputValue, // Update with your API endpoint
    //                 method: 'GET',
    //                 success: function (data) {
    //                     // Assume data is an array of objects with 'name' and 'symbol' properties
    //                     var $symbolSelect = $('#symbolSelect');
    //                     $symbolSelect.empty(); // Clear existing options
    //                     // Populate the select dropdown with API results
    //                     $.each(data, function (index, item) {
    //                         $symbolSelect.append($('<option/>', {
    //                             value: item.id,
    //                             text: `${item.symbol} (${item.name})` // Adjust according to your API response
    //                         }));
    //                     });

    //                     // Show the select and hide the input
    //                     $symbolSelect.show();
    //                     $symbolSelect.focus();

    //                     //$('#symbolInput').hide();

    //                 },
    //                 error: function () {
    //                     // Handle errors here
    //                     alert("Error fetching data.");
    //                 }
    //             });
    //         } else {
    //             // Hide the select and show the input if less than 2 characters
    //             $('#symbolSelect').hide();
    //             $('#symbolInput').show();
    //         }
    //     });

    //     // On change of select, show the select with chosen value
    //     $('#symbolSelect').on('change', function () {
    //         $('#symbolSelect').hide();
    //         $('#symbolInput').val($(this).val()).show();
    //     });
    // });
</script>